{{ define "title" }}
containerd docs &ndash; {{ cond (eq .Title "") (.File.BaseFileName | humanize | title) .Title }}
{{ end }}

{{ define "main" }}
{{- $section := .Section }}
{{- $pages   := where .Site.Pages "Section" $section }}

{{ partial "hero.html" . }}
{{ $Content := .Content }}

<article class="is-{{ $section }}-article">
  <div class="container">
    <div class="columns">
      {{ partial "docs/sidebar.html" . }}

      <div class="column is-two-thirds is-full-mobile">
        <div class="content">
          <div class="is-hidden-desktop">
            {{ partial "docs/dropdown.html" . }}
          </div>
    
          <section class="is-inner-content">
            <!-- remove instances of .md to fix links to other docs -->
            {{- $content := (replaceRE `\.md` "" .Content) }}
            <!-- point image links at GH repo since hugo is dumb and won't find non md files in content/ -->
            {{- $xVersion := index (findRE `v\d+\.\d+\.x` .RelPermalink) 0 }}
            {{- $xVersion := replace (replace $xVersion "v" "") ".x" "" }}
            {{- $content := (replaceRE `(!\[.*\])\(([^http].*)\)` "$1https://github.com/containerd/containerd/blob/release/$xVersion/$2?raw=true" $content) }}

            {{ $content | safeHTML }}
          </section>
        </div>
      </div>

      <div class="column is-hidden-touch">
        {{- if .TableOfContents }}
        <aside class="is-toc-container">
          <p class="is-toc-title">
            On this page
          </p>

          <div id="toc">
            {{ .TableOfContents }}
          </div>
        </aside>
        {{- end }}
      </div>
    </div>
  </div>
</article>

{{ partial "docs/arrow-up.html" . }}
{{ end }}
